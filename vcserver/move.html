<!doctype html>
<html>
  <head>
      <title>nodejs control</title>
  </head>
  <body>
      alpha:<span id="alpha"></span><br/>
      beta:<span id="beta"></span><br/>
      gamma:<span id="gamma"></span><br/>
      x:<span id="x"></span><br/>
      y:<span id="y"></span><br/>
      z:<span id="z"></span><br/>

      <script src="/socket.io/socket.io.js"></script>
      <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
      <script type="text/javascript">
      //
      // MJPEG
      //
      var socket = io();
      var sampletime = 10;

      $(function() {
          window.addEventListener('deviceorientation', function(event) 
          {
              var alpha = event.alpha;
              var beta  = event.beta;
              var gamma = event.gamma;

              xhtml = document.getElementById('x');
              yhtml = document.getElementById('y');
               
              
              a = document.getElementById('alpha');
              b = document.getElementById('beta');
              g = document.getElementById('gamma');
	      x = Math.round(beta);
              y = Math.round(gamma);
              if (Math.abs(x)>4 || Math.abs(y)>4 )
              {
                  xhtml.innerHTML = Math.round(x);
                  yhtml.innerHTML = Math.round(y);

                  var message = {
                      x: x,
                      y: y,
                  }
                  socket.emit('control', JSON.stringify(message));

                  setTimeout(function(){}, sampletime);  
              }
              setTimeout(function(){}, sampletime);
              a.innerHTML = Math.round(alpha);
              b.innerHTML = Math.round(beta);
              g.innerHTML = Math.round(gamma);


          }, false);

      });
    </script>
  </body>
</html>
